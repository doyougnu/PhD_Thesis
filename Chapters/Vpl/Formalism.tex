\label{section:vpl:formalism}
%
Having defined the syntax and semantics of \ac{vpl} the rest of this chapter
will define useful functions and properties. We conclude the chapter with an
example of encoding a set of \pl{} formulas to a single \ac{vpl} formula.
%
First define useful functions to retrieve interesting aspects of \ac{vpl}
formulas.

\begin{definition}[Dimensions]
  Given a formula $f \in \ac{vpl}$, let $\dimensions{f}$ be the set of unique
  dimensions in the formula:  $\dimensions{f} = \{ D\ |\ D \in f \}$.
\end{definition}

For example, \dimensions{\chc[A]{p,q}\wedge\chc[B]{r,s}} = $\{\kf{A,B}\}$ and
\dimensions{\chc[A]{p,q}\wedge\chc[A]{r,s}} = $\{\kf{A}\}$.
%
Similarly we define a notion of \emph{cardinality} over \ac{vpl} formulas.
%
\begin{definition}[Dimension-cardinality]
  The dimension-cardinality or d-cardinality of a formula $f \in \ac{vpl}$ is
  the cardinality of the set of unique dimensions in a formula. We use the
  following notation as shorthand: $\dcardinality{f} = |{\dimensions{f}}|$.
\end{definition}

Similarly to $\kf{Dimensions}$ another useful function is $\kf{Variants}$:

\begin{definition}[Variants]
  Given a formula $f \in \ac{vpl}$, let $\variants{f}$ be the set of all
  possible \emph{plain variants} of $f$. Thus, $\variants{f} = \{\ v\ |\ \exists C.\
  v = \sem[C]{f},\ v \in \pl{} \,\}$
\end{definition}

Using $\kf{Dimensions}$ we can now define a more precise property on
configurations.
%
\begin{definition}[Valid Configuration]
  We say a configuration $C$ is valid with respect to some formula $f \in
  \ac{vpl}$ iff $\kf{Dom(C)}\ \cap\ \kf{Dimensions(\kf{f})\ \neq \varnothing}$.
\end{definition}

One may think of a valid configuration as a total configuration with
\emph{nothing extra}. For example, the configuration $C = \{\kf{(A,\true),
  (B,\false),(E,\true)}\}$ is total with respect to the formula $f =
\chc[A]{p,q}\wedge\chc[B]{r,s}$ because $C$ eliminates all choices in $f$.
However $\kf{C}$ is not valid with respect to $f$ as $\kf{Dom(C)}\ \cap\
\kf{Dimensions(\kf{f})\ = \{\kf{E}\}}$, and thus in this case $C$ contains one
extra binding for $E$, than needed with respect to $f$.

With these functions and definitions we can prove useful lemmas and theorems.
%
We'll begin by proving that the configuration semantics over an \ac{vpl} formula
is mathematically surjective, or in programming language terminology
\emph{confluent}, \ie{}, each configuration with respect to a \ac{vpl} formula
precisely specifies one variant.
%
\begin{theorem}[\ensuremath{\sem[C]{f}} is Confluent]
  \label{thm:vpl:confluent}
  If $C$ is total then \ensuremath{\semL f \semR_{C}} is confluent
\end{theorem}
%
\begin{proof}
  By structural induction on the relation \sem[C]{f} proceeding by case
  analysis. We need to show that given a total configuration $\kf{C}$, only a
  single variant can result from configuration of $\kf{f}$ with $\kf{C}$. Since
  $\kf{C}$ is total, $\kf{C : \dim{} \rightarrow \booleans{}}$. The only
  interesting case is the case for choices, since $\kf{C}$ is total with respect
  to $\kf{f}$, $\kf{D \in C}$. Furthermore, because of synchronization $C(D)$
  can only return the same value for each instance of a choice with dimension
  $\kf{D}$, thus the same alternative is selected and recursively processed by
  definition of \sem[]. Should the alternative contain a choice with a new
  dimension $\kf{C'}$ then the same case occurs by assumption that $\kf{C}$ is
  total. Every other case, such as $\wedge{}$, $\vee$, or $\neg$ is recursive,
  thus creating smaller derivations until a base case on $\kf{t}$ or a choice.
\end{proof}
%
Similarly, clearly \ac{vpl} reduces to \pl{}:
%
\begin{theorem}[\ac{vpl} reducible to \pl{}]
  \label{thm:vpltopl}
  For any configuration $C$ and any formula $f \in \ac{vpl}$, if $C$ is total
  with respect to $f$, then $\sem[C]{f} \in \pl{}$
\end{theorem}
%
\begin{proof}
  This follows directly from the semantics of configuration in
  \autoref{fig:cc:cfg}, and the definition of a total configuration. The proof
  is done by structural induction and case analysis; because $C$ is total and
  the configuration semantic function is a total function, every choice and its'
  alternatives is recursively reified for $f$. Then by the definition of
  \ac{vpl} a formula which lacks choices is $\in \pl{}$.
\end{proof}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../thesis"
%%% End: