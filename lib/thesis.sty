\NeedsTeXFormat{LaTeX2e}

%
% Macros defined just for this paper
%
\ProvidesPackage{lib/thesis}

%%%%%% Convenient commands for the paper
\newcommand{\kf}[1]{\mathit{#1}}              %% fix kerning

% inline TODOs
\newcommand{\itodo}[1]{\{{\color{red} #1}\}}

% macros for the major characters
\newcommand{\vsat}{VSAT}
\newcommand{\vsmt}{VSMT}
\newcommand{\hquad}{\hspace{0.5em}}
\newcommand{\ifdf}{\texttt{\#ifdef}}
\newcommand{\pl}{{C\textsubscript{2}}}  %% propositional logic
\newcommand{\recipe}{\text{variational system}}

%% bool values for propositions
\newcommand{\fls}{\texttt{F}}
\newcommand{\tru}{\texttt{T}}
\newcommand{\assign}{\ensuremath{\coloneqq{}}}

%% Convenient name macros
\newcommand{\christian}{KÃ¤stner \etal}
\newcommand{\nieke}{{Nieke \etal}}
\newcommand{\tc}{TypeChef}
\newcommand{\bsybx}{BusyBox}
\newcommand{\linux}{Linux}
\newcommand{\auto}{\textit{auto}}
\newcommand{\fin}{\textit{fin}}

%%% Research questions to be answered
\newcommand{\resQ}[1]{\textbf{RQ#1}}

%%% CUSTOM COMMANDS
\newcommand{\eric}[1]{\todo[color=pink]{#1 -E}}

\providecommand{\eg}[0]{e.g\xperiod}
\providecommand{\ie}[0]{i.e\xperiod}
\providecommand{\etal}[0]{et~al\xperiod}
\providecommand{\cf}[0]{cf\xperiod}
\providecommand{\aka}[0]{aka\xperiod}
\providecommand{\ia}[0]{i.a\xperiod}
\providecommand{\wrt}[0]{w.r.t\xperiod}

\renewcommand*{\figureautorefname}{Fig.}
\renewcommand*{\equationautorefname}{Eq.}
\ifcsname sectionautorefname\endcsname
\renewcommand*{\sectionautorefname}{Sec.}
\fi
\ifcsname subsectionautorefname\endcsname
\renewcommand*{\subsectionautorefname}{Sec.}
\fi
\ifcsname subsubsectionautorefname\endcsname
\renewcommand*{\subsubsectionautorefname}{Sec.}
\fi
\newcommand{\lstnumberautorefname}{Line}

%%%%%%%%%%%%%%%%%%%% background example helpers
\newcommand{\mkVar}[1]{\ensuremath{\kf{#1}}}
\newcommand{\pV}{\mkVar{p}}
\newcommand{\qV}{\mkVar{q}}
\newcommand{\rV}{\mkVar{r}}
\newcommand{\fV}{\mkVar{f}}
\newcommand{\gV}{\mkVar{g}}
\newcommand{\iV}{\mkVar{i}}
\newcommand{\aV}{\mkVar{a}}
\newcommand{\bV}{\mkVar{b}}
\newcommand{\cV}{\mkVar{c}}
\newcommand{\dV}{\mkVar{d}}
\newcommand{\eV}{\mkVar{e}}
\newcommand{\zV}{\mkVar{z}}
\newcommand{\AV}{\mkVar{A}}
\newcommand{\BV}{\mkVar{B}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% VPL Figures
\newcommand{\dimd}{$d$}
\newcommand{\dimP}{\ensuremath{P}}
\newcommand{\dimQ}{\ensuremath{Q}}
\newcommand{\dimR}{\ensuremath{R}}
\newcommand{\true}[0]{\OB{\mathsf{true}}}
\newcommand{\false}[0]{\OB{\mathsf{false}}}
\newcommand{\unit}[0]{\ensuremath{\bullet{}}}
\newcommand{\ap}[1]{\{#1\}}
\newcommand{\vc}[1]{\ensuremath{\kf{vc}_{#1}}}         % fmf macro w/ subscript
\newcommand{\vcT}{\vc{True}}                    % fmf with true subscript
\newcommand{\vcF}{\vc{False}}
\newcommand{\mdl}[1]{$\kf{mdl}_{#1}$}           % model macro
\newcommand{\mdls}{$mdls$}                           % mdls helper
\newcommand{\SatVar}{\ensuremath{\_Sat}}                        %_Sat
\newcommand{\SatModel}{\mdl{Sat}}
\newcommand{\Satvc}{\vc{_{\_Sat}}}
\newcommand{\lift}[1]{\ensuremath{#1^{\chcL{}\chcR{}}}}

%%% macro for all combinations of two features
\newcommand{\ViByVj}[2]{$\mathit{V_{#1}*V_{#2}}$}
\newcommand{\ViToVj}[2]{$\mathit{V_{#1}**V_{#2}}$}

%%% Arrows
\newcommand{\iToj}[2]{$\textit{#1}{\rightarrow}\textit{#2}$}
\newcommand{\pTop}[0]{\iToj{p}{p}}
\newcommand{\pTov}[0]{\iToj{p}{v}}
\newcommand{\vTop}[0]{\iToj{v}{p}}
\newcommand{\vTov}[0]{\iToj{v}{v}}

%%%%%%%%%%%%%%%%% Journal version differnces
\newcommand{\newcolor}{blue}
\newcommand{\pubcolor}{black}
% swapped to black for pub, jmy 26/02/2021
% \newcommand{\new}[1]{{\color{\newcolor}#1}}
\newcommand{\new}[1]{{\color{\pubcolor}#1}}
\newenvironment{newBlock}{\color{\revcolor}}{\color{\nocolor}}

%%%%%%%%%%%%%%%% Sets
\newcommand{\nats}[0]{\ensuremath{\mathbb{N}_{0}}}
\newcommand{\integers}{\ensuremath{\mathbb{Z}}}
\newcommand{\booleans}{\ensuremath{\mathbb{B}}}

%%%%%%%%%%%%%%% Combinators
\newcommand{\range}[1]{\ensuremath{\kf{Ra}({#1})}}
\newcommand{\domain}[1]{\ensuremath{\kf{Dom}({#1})}}
\newcommand{\with}[2]{\ensuremath{#1^{#2}}}
\WithSuffix\newcommand\prime*[1]{\ensuremath{\with{#1}{'}}}

%%%%%%%%%%%%%%% shorthand ops for inference rules
\newcommand{\evpl}{\ensuremath{\kf{\ac{vpl}^{\integers}}}}
\newcommand{\eIL}{\ensuremath{\kf{v^{\integers}}}}
\newcommand{\eAR}{\ensuremath{\kf{ar^{\integers}}}}
\WithSuffix\newcommand\eIL*[1]{\ensuremath{\kf{v_{#1}^{\integers}}}}
\WithSuffix\newcommand\eAR*[1]{\ensuremath{\kf{ar_{#1}^{\integers}}}}
\newcommand{\inequalities}{\ensuremath{\bowtie{}}}
\newcommand{\integerFuncs}{\ensuremath{\oplus{}}}
\newcommand{\boolFuncs}{\ensuremath{\otimes{}}}
\newcommand{\integerUnary}{\ensuremath{\dagger{}}}
\newcommand{\uop}[1]{\ensuremath{\kf{U}_{#1}}}
\newcommand{\bop}[1]{\ensuremath{\kf{B}_{#1}}}
\newcommand{\sop}{\ensuremath{\kf{S}}}
\newcommand{\ui}{\uop{\integers{}}}
\newcommand{\ub}{\uop{\booleans{}}}
\newcommand{\bbb}{\bop{\booleans{}\booleans}}
\newcommand{\bib}{\bop{\integers{}\booleans}}
\newcommand{\bii}{\bop{\integers{}\integers}}

%%%% accumulation
\newcommand{\e}[1]{\ensuremath{e_{#1}}}
\newcommand{\aStore}[1]{\ensuremath{\Delta_{#1}}}
\newcommand{\accumulation}{\ensuremath{\mapsto{}}}
\newcommand{\acChc}{\rn{A-Chc}}
\newcommand{\acRef}{\rn{A-Ref}}
\newcommand{\acNotS}{\rn{A-Not-S}}
\newcommand{\acAndS}{\rn{A-And-S}}
\newcommand{\acOrS}{\rn{A-Or-S}}
\newcommand{\acNotV}{\rn{A-Not-V}}
\newcommand{\acAndV}{\rn{A-And-V}}
\newcommand{\acOrV}{\rn{A-Or-V}}

%%%% evaluation
\newcommand{\eStore}[1]{\ensuremath{\Gamma_{#1}}}
\newcommand{\eaStore}{\ensuremath{\eStore,\aStore}}
\newcommand{\evaluation}{\ensuremath{\rightarrowtail{}}}
\newcommand{\evAcc}{\rn{E-Acc}}
\newcommand{\evSym}{\rn{E-Sym}}
\newcommand{\evChc}{\rn{E-Chc}}
\newcommand{\evAndL}{\rn{E-And-L}}
\newcommand{\evAndR}{\rn{E-And-R}}
\newcommand{\evAnd}{\rn{E-And}}
\newcommand{\evOr}{\rn{E-Or}}

%%%% Zipper
\newcommand{\inRoot}{\ensuremath{\top}}


%% breadcrumb style 2
\newcommand{\inNot}[1]{\ensuremath{\neg\,\cdot :: #1}}
\newcommand{\inAndL}[2]{\ensuremath{\cdot\wedge #2 :: #1}}
\newcommand{\inAndR}[2]{\ensuremath{#1 \wedge\cdot :: #2}}
\newcommand{\inOrL}[2]{\ensuremath{\cdot\vee #2 :: #1}}
\newcommand{\inOrR}[2]{\ensuremath{#1 \vee\cdot :: #2}}

%%%% Choice Removal
\newcommand{\choiceRemoval}{\ensuremath{\Downarrow}}
\newcommand{\configuration}{\ensuremath{\kf{C}}}
\newcommand{\crCtx}{\configuration{},\eStore{},\aStore{},\vmodel{}}
\newcommand{\vmodel}[1]{\ensuremath{M_{#1}}}
\newcommand{\crEval}{\rn{C-Eval}}
\newcommand{\crNot}{\rn{C-Not}}
\newcommand{\crNotIn}{\rn{C-Not-In}}
\newcommand{\crAnd}{\rn{C-And}}
\newcommand{\crAndL}{\rn{C-And-InL}}
\newcommand{\crAndR}{\rn{C-And-InR}}
\newcommand{\crOr}{\rn{C-Or}}
\newcommand{\crOrL}{\rn{C-Or-InL}}
\newcommand{\crOrR}{\rn{C-Or-InR}}
\newcommand{\crChc}{\rn{C-Chc}}
\newcommand{\crChcT}{\rn{C-Chc-T}}
\newcommand{\crChcF}{\rn{C-Chc-F}}

\newcommand{\crGen}{\TODO{C-Gen}}
\newcommand{\crSym}{\TODO{C-Sym}}
\newcommand{\crChcAnd}{\TODO{C-Chc-And}}

%%%%% primitive operations
\newcommand{\lookup}[2]{\ensuremath{#2[#1]}}

%%%% Bools
\newcommand{\primOp}[1]{\texttt{#1}}
\newcommand{\pspawn}{\primOp{Var}}
\newcommand{\pspawni}{\primOp{Var\textsubscript{i}}}
\newcommand{\pnot}{\primOp{Not}}
\newcommand{\pand}{\primOp{And}}
\newcommand{\por}{\primOp{Or}}
\newcommand{\pmodel}{\primOp{GetModel}}
\newcommand{\passert}{\primOp{Assert}}
\newcommand{\pcombine}{\primOp{Combine}}
\newcommand{\pwrap}[1]{\underline{#1}}

%%%% Arithmetic
\newcommand{\pneg}{\primOp{Neg}}
\newcommand{\padd}{\primOp{Add}}
\newcommand{\psub}{\primOp{Sub}}
\newcommand{\pdiv}{\primOp{Div}}
\newcommand{\pmult}{\primOp{Mult}}

%%%% Inequalities
\newcommand{\plt}{\primOp{Lt}}
\newcommand{\plte}{\primOp{Lte}}
\newcommand{\pgt}{\primOp{Gt}}
\newcommand{\pgte}{\primOp{Gte}}
\newcommand{\peq}{\primOp{Eqv}}

%%%%%%%%% Proof helpers
\newcommand{\dcardinality}[1]{\ensuremath{|#1|_{D}}}
\newcommand{\variants}[1]{\ensuremath{\kf{Variants}(#1)}}
\newcommand{\dimensions}[1]{\ensuremath{\kf{Dimensions(#1)}}}

%%%%% VSMT accumulation
\newcommand{\acRefI}{\rn{A-Ref-I}}
\newcommand{\op}{\ensuremath{\sigma}}
\newcommand{\acUnaryS}{\rn{A-Unary-S}}
\newcommand{\acBoolS}{\rn{A-Bool-S}}
\newcommand{\acArithS}{\rn{A-Arith-S}}
\newcommand{\acInEqS}{\rn{A-InEq-S}}
\newcommand{\acChcI}{\rn{A-Chc-I}}
\newcommand{\acBoolV}{\rn{A-Bool-V}}
\newcommand{\acArithV}{\rn{A-Arith-V}}
\newcommand{\acInEqV}{\rn{A-InEq-V}}
\newcommand{\acUnaryV}{\rn{A-Unary-V}}

%%%%% VSMT evaluation
\newcommand{\evChcI}{\rn{E-Chc-I}}
\newcommand{\evArith}{\rn{E-Arith}}
\newcommand{\evInEq}{\rn{E-InEq}}

%% breadcrumb style for vsmt
\newcommand{\zipper}{\ensuremath{z^{\integers}}}
\newcommand{\inUnary}[1]{\ensuremath{\integerUnary\,\cdot :: #1}}
\newcommand{\inBoolL}[2]{\ensuremath{\cdot\boolFuncs #2 :: #1}}
\newcommand{\inBoolR}[2]{\ensuremath{#1 \boolFuncs\cdot :: #2}}
\newcommand{\inArithL}[2]{\ensuremath{\cdot\integerFuncs #2 :: #1}}
\newcommand{\inArithR}[2]{\ensuremath{#1 \integerFuncs\cdot :: #2}}
\newcommand{\inInEqL}[2]{\ensuremath{\cdot\inequalities #2 :: #1}}
\newcommand{\inInEqR}[2]{\ensuremath{#1 \inequalities \cdot :: #2}}

\WithSuffix\newcommand\inUnary*[2]{\ensuremath{#2\,\cdot :: #1}}
\WithSuffix\newcommand\inBoolL*[3]{\ensuremath{\cdot#3 #2 :: #1}}
\WithSuffix\newcommand\inBoolR*[3]{\ensuremath{#1 #3 \cdot :: #2}}
\WithSuffix\newcommand\inArithL*[3]{\ensuremath{\cdot#3 #2 :: #1}}
\WithSuffix\newcommand\inArithR*[3]{\ensuremath{#1 #3 \cdot:: #2}}
\WithSuffix\newcommand\inInEqL*[3]{\ensuremath{\cdot#3 #2 :: #1}}
\WithSuffix\newcommand\inInEqR*[3]{\ensuremath{#1 #3 \cdot :: #2}}

%%%% Choice Removal
\newcommand{\crUnary}{\rn{C-Unary}}
\newcommand{\crUnaryIn}{\rn{C-Unary-In}}
\newcommand{\crBool}{\rn{C-Bool}}
\newcommand{\crBoolL}{\rn{C-Bool-InL}}
\newcommand{\crBoolR}{\rn{C-Bool-InR}}
\newcommand{\crInEq}{\rn{C-InEq}}
\newcommand{\crInEqL}{\rn{C-InEq-InL}}
\newcommand{\crInEqR}{\rn{C-InEq-InR}}
\newcommand{\crArith}{\rn{C-Arith}}
\newcommand{\crArithL}{\rn{C-Arith-InL}}
\newcommand{\crArithR}{\rn{C-Arith-InR}}

%%%% variational smt models
\newcommand{\undefined}{\ensuremath{\kf{Und}}}
\newcommand{\bigOof}[1]{\ensuremath{\mathcal{O(\kf{#1})}}}

%%%% example
\newcommand{\hV}{\mkVar{h}}

%%%% arrays
\newcommand{\store}{\ensuremath{\kf{store}}}
\newcommand{\select}{\ensuremath{\kf{select}}}
\WithSuffix\newcommand\store*[3]{\ensuremath{(\kf{store}~#1~#2~#3)}}
\WithSuffix\newcommand\select*[2]{\ensuremath{(\kf{select}~#1~#2)}}
\newcommand{\inSelectL}[3]{\store*{\cdot}{#1}{#2} :: #3}
\newcommand{\inSelectM}[3]{\store*{#1}{\cdot}{#2} :: #3}
\newcommand{\inSelectR}[3]{\store*{#1}{#2}{\cdot} :: #3}
\newcommand{\inStoreL}[2]{\select*{\cdot}{#1} :: #2}
\newcommand{\inStoreR}[2]{\select*{#1}{\cdot} :: #2}

%%%% Case Studies helpers
\newcommand{\github}[0]{\url{https://github.com/lambda-land/VSat-Papers/tree/master/EMSE2021}}
